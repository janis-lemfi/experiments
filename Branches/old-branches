#!/bin/bash

VAR=$1

if [[ $VAR == "short" ]]; then
  git fetch --prune
  git for-each-ref \
    --sort=committerdate\
    --format="%(committerdate:short) %(refname:short)" refs/remotes/ \
    | grep -v HEAD \
    | awk -v date="$(date -v-3m +%Y-%m-%d)" '$1 < date' \
    | awk '{print $2}'
else
  git fetch --prune
  echo "| Date | Author | Ref name|"
  echo "|------|--------|---------|"
  git for-each-ref \
    --sort=-committerdate\
    --sort=authorname \
    --format="| %(committerdate:short) | %(authorname) | %(refname:short) |" refs/remotes/ \
    | grep -v HEAD \
    | awk -v date="$(date -v-3m +%Y-%m-%d)" '$2 < date'
fi
